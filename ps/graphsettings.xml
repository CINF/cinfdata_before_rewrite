<?xml version='1.0' standalone='yes'?>
<graphs>
 
  <!-- MULTI DATEPLOT -->
  <graph type='multidateplot_turbo'>
    <default_xscale>dat</default_xscale>
    <xlabel>Date</xlabel>
    <right_legend_suffix> (r)</right_legend_suffix>
    <!-- Fall back settings -->
    <title>Multiple dateplots</title>
    <ylabel>Mixed</ylabel>
    <dygraph_settings>
      <roll_period>1</roll_period>
    </dygraph_settings>

    <!-- Date plot 1 - Turbo speed -->
    <dateplot1>
      <title>Turbo, Main chamber, rotation</title>
      <legend>MC, rotation</legend>
      <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 74 and time between "{from}" and "{to}" order by time</query>
      <ylabel>Rotation speed / Hz</ylabel>
      <color>1</color>
    </dateplot1>

    <!-- Date plot 2 - Drive Current -->
    <dateplot2>
      <title>Turbo, Main chamber, Current</title>
      <legend>MC, Current</legend>
      <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 73 and time between "{from}" and "{to}" order by time</query>
      <ylabel>Drive Current / A</ylabel>
      <color>2</color>
    </dateplot2>

    <!-- Date plot 3 - Drive Power -->
    <dateplot3>
      <title>Turbo, Main chamber, Power</title>
      <legend>MC, Power</legend>
      <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 78 and time between "{from}" and "{to}" order by time</query>
      <ylabel>Drive Power / W</ylabel>
      <color>3</color>
    </dateplot3>

    <!-- Date plot 4 - temp_motor -->
    <dateplot4>
      <title>Turbo, Main Chamber, Motor Temp</title>
      <legend>MC, Motor Temp</legend>
      <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 72 and time between "{from}" and "{to}" order by time</query>
      <ylabel>Motor Temperature / C</ylabel>
      <color>4</color>
    </dateplot4>

    <!-- Date plot 5 - temp_electronics -->
    <dateplot5>
      <title>Turbo, Main Chamber, Electronics Temp</title>
      <legend>MC, Electronics Temp</legend>
      <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 77 and time between "{from}" and "{to}" order by time</query>
      <ylabel>Electronics Temperature / C</ylabel>
      <color>5</color>
    </dateplot5>

    <!-- Date plot 6 - temp_bottom -->
    <dateplot6>
      <title>Turbo, Main Chamber, Temp Bottom</title>
      <legend>MC, Temp Bottom</legend>
      <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 75 and time between "{from}" and "{to}" order by time</query>
      <ylabel>Temperature Bottom/ C</ylabel>
      <color>6</color>
    </dateplot6>

    <!-- Date plot 9 - temp_bearings -->
    <dateplot7>
      <title>Turbo, Main Chamber, Bearings Temp</title>
      <legend>MC, Bearings Temp</legend>
      <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 76 and time between "{from}" and "{to}" order by time</query>
      <ylabel>Bearings Temperature / C</ylabel>
      <color>7</color>
    </dateplot7>
  </graph>

  <!-- MASSSPECTRUM -->
  <graph type='massspectrum'>
    <query>SELECT x,y  FROM xy_values_ps where measurement = {id} order by id</query>
    <offset_query>SELECT min(y) FROM xy_values_ps where measurement = {id}</offset_query>
    <type>4</type>
    <image_format>pdf</image_format>
    <xlabel>Mass / amu</xlabel>
    <ylabel>SEM current / A</ylabel>
    <title>Mass Spectrum</title>
    <default_xscale>lin</default_xscale>
    <default_yscale>log</default_yscale>
    <param0_field>sem_voltage</param0_field>
    <param0_name>SEM Voltage / V</param0_name>
    <param1_field>preamp_range</param1_field>
    <param1_name>Range</param1_name>
  </graph>
  
  <!-- MASSTIME -->
  <graph type='masstime'>
    <query>SELECT x/1000,y  FROM xy_values_ps where measurement = {id} order by id</query>
    <t_query>SELECT x/1000,y FROM xy_values_ps where measurement = {t_id} order by id</t_query>
    <type>5</type>
    <image_format>pdf</image_format>
    <xlabel>Time / s</xlabel>
    <t_xlabel>Sample Temperature / </t_xlabel>
    <temperature_unit>K</temperature_unit>
    <ylabel>SEM current / A</ylabel>
    <!-- Title for mass vs. time -->
    <title>Mass vs. time</title>
    <!-- Title for mass vs. temperature -->
    <t_title>Mass vs. temperature</t_title>
    <legend_field_name>mass_label</legend_field_name>
    <right_y_axis_field_name>mass_label</right_y_axis_field_name>
    <right_y_axis_field_value>Sample Temperature</right_y_axis_field_value>
    <right_yscale>lin</right_yscale>
    <right_ylabel>Temperature / K</right_ylabel>
    <default_xscale>lin</default_xscale>
    <default_yscale>lin</default_yscale>
    <param0_field>sem_voltage</param0_field>
    <param0_name>SEM Voltage / V</param0_name>
    <param1_field>preamp_range</param1_field>
    <param1_name>Range</param1_name>
  </graph>



  <!-- MORNING_PRESSURE -->
  <graph type='morning_pressure'>
    <query>select unix_timestamp(date(time)), avg(pressure) from pressure_ps where hour(time) = 1 and minute(time) between 00 and 20 and time between "{from}" and "{to}" group by date(time) order by time desc limit 30</query>
    <ylabel>Pressure / mbar</ylabel>
    <title>Pressure at 1 am in the Microreactor Chamber</title>
    <default_yscale>log</default_yscale>
    <default_xscale>dat</default_xscale>
    <default_style>barplot</default_style>
  </graph>


  <!-- PRESSURE, ION GAUGE -->
  <graph type='pressure'>
    <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 70 and time between "{from}" and "{to}" order by time</query>
    <ylabel>Chamber pressure / mbar</ylabel>
    <title>Pressure in the Parallel Screening Chamber</title>
    <default_yscale>log</default_yscale>
    <default_xscale>dat</default_xscale>
    <small_fig_settings>figure.figsize:[4,3.0]|xtick.labelsize:small|ytick.labelsize:small</small_fig_settings>
  </graph>

  <!-- PRESSURE, ION GAUGE -->
  <graph type='pressure_qms'>
    <query>SELECT unix_timestamp(time), value FROM dateplots_ps where type = 79 and time between "{from}" and "{to}" order by time</query>
    <ylabel>Chamber pressure / mbar</ylabel>
    <title>Pressure in the Parallel Screening QMS Chamber</title>
    <default_yscale>log</default_yscale>
    <default_xscale>dat</default_xscale>
    <small_fig_settings>figure.figsize:[4,3.0]|xtick.labelsize:small|ytick.labelsize:small</small_fig_settings>
  </graph>

  <!-- TEMPERATURE -->
  <graph type='temperature'>
    <query>SELECT unix_timestamp(time), temperature FROM temperature_ps where time between "{from}" and "{to}" order by time</query>
    <ylabel>Temperature / K</ylabel>
    <title>Temperature in the Parallel Screening Chamber</title>
    <default_yscale>lin</default_yscale>
    <default_xscale>dat</default_xscale>
    <image_format>pdf</image_format>
    <small_fig_settings>figure.figsize:[4,3.0]|xtick.labelsize:small|ytick.labelsize:small</small_fig_settings>
  </graph>

  <!-- DEPOSITION -->
  <graph type='deposition'>
    <query>SELECT x/1000,y*100  FROM xy_values_ps where measurement = {id} order by id</query>
    <type>9</type>
    <image_format>pdf</image_format>
    <xlabel>Time / s</xlabel>
    <ylabel>Thickness / nm</ylabel>
    <title>Deposition</title>
    <right_y_axis_field_name>mass_label</right_y_axis_field_name>
    <right_y_axis_field_value>Frequency</right_y_axis_field_value>
    <right_yscale>lin</right_yscale>
    <right_ylabel>Frequency / Hz</right_ylabel>
    <default_xscale>lin</default_xscale>
    <default_yscale>lin</default_yscale>
    <legend_field_name>mass_label</legend_field_name>
  </graph>
    
  <global_settings>
    <measurements_table>measurements_ps</measurements_table>
    <xyvalues_table>xy_values_ps</xyvalues_table>
    <chamber_name>tower</chamber_name>
    <sql_username>PS</sql_username>
  </global_settings>
</graphs>
